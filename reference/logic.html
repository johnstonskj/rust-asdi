<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Appendix: Horn Clause Mapping - Another Simplistic Datalog Implementation (in Rust)</title>


        <!-- Custom HTML head -->
        <link   rel="stylesheet"
                href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
                integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs"
                crossorigin="anonymous">
        <script defer
                src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
                integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx"
                crossorigin="anonymous"></script>
        <script defer
                src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js"
                integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"
                crossorigin="anonymous"></script>
        
        <script defer>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "\\(", right: "\\)", display: false},
                    {left: "$", right: "$", display: false},
                    {left: "\\[", right: "\\]", display: true}
                ]
            });
        });
        </script>
        

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../asdi.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../datalog/index.html"><strong aria-hidden="true">2.</strong> Datalog</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../datalog/abstract.html"><strong aria-hidden="true">2.1.</strong> Abstract Syntax</a></li><li class="chapter-item expanded "><a href="../datalog/concrete.html"><strong aria-hidden="true">2.2.</strong> Concrete Syntax</a></li><li class="chapter-item expanded "><a href="../datalog/features.html"><strong aria-hidden="true">2.3.</strong> Language Features</a></li></ol></li><li class="chapter-item expanded "><a href="../model/index.html"><strong aria-hidden="true">3.</strong> Model API</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../model/programs.html"><strong aria-hidden="true">3.1.</strong> Programs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../model/program_features.html"><strong aria-hidden="true">3.1.1.</strong> Features</a></li><li class="chapter-item expanded "><a href="../model/program_parser.html"><strong aria-hidden="true">3.1.2.</strong> Parser</a></li><li class="chapter-item expanded "><a href="../model/program_visitor.html"><strong aria-hidden="true">3.1.3.</strong> Visitor</a></li></ol></li><li class="chapter-item expanded "><a href="../model/relations.html"><strong aria-hidden="true">3.2.</strong> Relations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../model/relation_io.html"><strong aria-hidden="true">3.2.1.</strong> Input/Output</a></li></ol></li><li class="chapter-item expanded "><a href="../model/rules.html"><strong aria-hidden="true">3.3.</strong> Rules</a></li><li class="chapter-item expanded "><a href="../model/eval.html"><strong aria-hidden="true">3.4.</strong> Evaluation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../model/eval_strata.html"><strong aria-hidden="true">3.4.1.</strong> Stratification</a></li></ol></li><li class="chapter-item expanded "><a href="../model/queries.html"><strong aria-hidden="true">3.5.</strong> Queries & Views</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../model/query_relational.html"><strong aria-hidden="true">3.5.1.</strong> Relational Algebra</a></li></ol></li><li class="chapter-item expanded "><a href="../model/errors.html"><strong aria-hidden="true">3.6.</strong> Error Handling</a></li></ol></li><li class="chapter-item expanded "><a href="../extension/index.html"><strong aria-hidden="true">4.</strong> Model Extension</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../extension/i_o.html"><strong aria-hidden="true">4.1.</strong> RelationSet I/O</a></li><li class="chapter-item expanded "><a href="../extension/evaluator.html"><strong aria-hidden="true">4.2.</strong> Writing an Evaluator</a></li><li class="chapter-item expanded "><a href="../extension/formatting.html"><strong aria-hidden="true">4.3.</strong> Writing a Formatter</a></li><li class="chapter-item expanded "><a href="../extension/contributing.html"><strong aria-hidden="true">4.4.</strong> Contributing</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/abstract_graph.html"><strong aria-hidden="true">5.</strong> Appendix: Abstract Graphical View</a></li><li class="chapter-item expanded "><a href="../reference/datalog_ebnf.html"><strong aria-hidden="true">6.</strong> Appendix: Datalog EBNF</a></li><li class="chapter-item expanded "><a href="../reference/relational.html"><strong aria-hidden="true">7.</strong> Appendix: Relational Algebra Mapping</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/relational_ebnf.html"><strong aria-hidden="true">7.1.</strong> Relational Algebra EBNF</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/logic.html" class="active"><strong aria-hidden="true">8.</strong> Appendix: Horn Clause Mapping</a></li><li class="chapter-item expanded "><a href="../reference/references.html"><strong aria-hidden="true">9.</strong> Appendix: References</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Another Simplistic Datalog Implementation (in Rust)</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/johnstonskj/rust-asdi" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="appendix-first-order-logic--horn-clauses"><a class="header" href="#appendix-first-order-logic--horn-clauses">Appendix: First-Order Logic &amp; Horn Clauses</a></h1>
<p>This section does not provide a primer on propositional logic, or first-order predicate logic. However, some background may be required and this section will briefly outline key terms, we refer the reader to <span class="bibref inline"><a href="../reference/references.html#AbHuVi94">AbHuVi94</a>, chapter 2</span>.</p>
<h2 id="propositional-logic"><a class="header" href="#propositional-logic">Propositional logic</a></h2>
<p>For Propositional logic we define a language comprising the following:</p>
<ol>
<li>An infinite set of propositional <em>variables</em>, $\small \mathcal{V}$.</li>
<li>The <em>constant</em> values <code>true</code> and <code>false</code>.</li>
<li>Propositional formulae $\small\varphi$, comprising variables, constants, the unary connective negation ($\small\lnot$) and the following binary connectives;
disjunction ($\small\lor$), conjunction ($\small\land$), implication ($\small\rightarrow$), and equivalence ($\small\leftrightarrow$).</li>
</ol>
<p>A <em>literal</em> is a (sub-)formula comprising a single variable or constant that may be negated, i.e. $\small p$ or $\small \lnot p$.</p>
<p>A propositional formula $\small\varphi$ is in <em>conjunctive normal form</em> (CNF) if it has the form</p>
<p>$$\tag{i}\small\psi_1 \land \cdots \land \psi_n$$</p>
<p>where each formula $\small\psi$ is a disjunction of literals.</p>
<h2 id="first-order-predicate-logic"><a class="header" href="#first-order-predicate-logic">First-Order Predicate logic</a></h2>
<p>First-Order Predicate logic is a more general language than propositional logic allowing predicate symbols that range over n-ary relationships. A <em>first-order language</em> $\small L$ is differentiated by the set of predicate symbols, constant values, and functions it chooses to allow.</p>
<ol>
<li>An infinite set of <em>variables</em> $\small \mathcal{V}$.</li>
<li>A set of constant values, $\small \mathcal{C}$, usually including <code>true</code> and <code>false</code>.</li>
<li>A set of n-ary predicate symbols, $\small \mathcal{P}$.</li>
<li>A set of n-ary function symbols, $\small \mathcal{F}$.</li>
<li><em>Well-formed formulae</em> (WFF) comprising variables, constants, the unary connective negation ($\small\lnot$) and the following binary connectives;
disjunction ($\small\lor$), conjunction ($\small\land$), implication ($\small\rightarrow$), and equivalence ($\small\leftrightarrow$).</li>
<li>The univeral quantifier $\small\forall$ and the existential quantifier $\small\exists$.</li>
</ol>
<p>An <em>atom</em> corresponds to the a propositional variable and is either <code>true</code>, <code>false</code>, or $\small p(t_1, \cdots, t_n)$, where $\small p$ is a predicate symbol and $\small t_1, \cdots, t_n$ are terms.</p>
<p>A <em>term</em> is either a variable, constant value, or function symbol.</p>
<p>Additionally, the language may include equality so as to allow atoms of the form $\small t_1 = t_2$. Note that <span class="bibref inline"><a href="../reference/references.html#AbHuVi94">AbHuVi94</a></span> uses $\small t_1 \approx t_2$.</p>
<h2 id="horn-clauses"><a class="header" href="#horn-clauses">Horn Clauses</a></h2>
<p>A Clause is simply a disjunctions of positive $\small a_1, \cdots, a_m$ and negative $\small b_1, \cdots, b_n$ literals and may be written in either of the following forms.</p>
<p>$$\tag{ii}\small a_1 \lor \cdots \lor a_m \lor \lnot b_1 \lor \cdots \lor \lnot b_n$$</p>
<p>$$\tag{iii}\small \forall x_1, \cdots, x_k (a_1 \lor \cdots \lor a_m \lor \lnot b_1 \lor \cdots \lor \lnot b_n)$$</p>
<p>Where the latter form introduces the set of variables used in the clause. This is often removed for clarity as the universal quantification is assumed for any variable present. This can also be written in <em>clausal form</em>, something that looks a lot like Datalog.</p>
<p>$$\tag{iv}\small a_1, \cdots, a_m \leftarrow b_1, \cdots, b_n$$</p>
<p>A <em>Horn Clause</em> is a formula consisting of a disjunction of literals of which <strong>at most one</strong> is positive.</p>
<p>$$\tag{vi}\small a \lor \lnot b_1 \lor \cdots \lor \lnot b_n$$</p>
<p>or, in clausal form,</p>
<p>$$\tag{vii}\small a_1 \leftarrow b_1, \cdots, b_n$$</p>
<p>The following table describes additional clause forms along with their equivalent Datalog form.</p>
<div class="table-wrapper"><table><thead><tr><th>Propositional</th><th>Form/Datalog</th><th>Clausal</th></tr></thead><tbody>
<tr><td>$\small a_1(x,y) \lor a_2(x,y) \lor \lnot b_1(x,z) \lor \lnot b_2(z,y)$</td><td>indefinite/disjunctive</td><td>$\small a_1(x,y), a_2(x,y) \leftarrow b_1(x,z), b_2(z,y)$</td></tr>
<tr><td>$\small a(x,y) \lor \lnot b_1(x,z) \lor \lnot b_2(z,y)$</td><td>definite/pure<sup class="footnote-reference"><a href="#1">1</a></sup></td><td>$\small a(x,y) \leftarrow b_1(x,z), b_2(z,y)$</td></tr>
<tr><td>$\small b(x,y)$</td><td>unit/fact<sup class="footnote-reference"><a href="#2">2</a></sup></td><td>$\small b(x,y) \leftarrow$</td></tr>
<tr><td>$\lnot b_1(x,z) \lor \lnot b_2(z,y)$</td><td>goal/constraint</td><td>$\small \leftarrow b_1(x,z), b_2(z,y)$</td></tr>
<tr><td>$\small false$ or $\small\bot$</td><td>empty</td><td>$\small \square$</td></tr>
</tbody></table>
</div>
<h2 id="mapping-from-datalog-to-first-order-logic"><a class="header" href="#mapping-from-datalog-to-first-order-logic">Mapping from Datalog to First-Order Logic</a></h2>
<p>The purpose of the descriptions above was to allow for the mapping of Datalog into a <em>first-order language</em>.</p>
<p>Given a Datalog program $\small P=( D_E, D_I, Q )$ we can construct a new first-order language $\small L=(\mathcal{C},\mathcal{P},\mathcal{F})$ in the following manner.</p>
<ol>
<li>$\mathcal{C}$ is comprised the set of all constant values in any EDB or IDB relation.
$$\small \lbrace c | c \in \bigcup \lbrace terms(atoms(r)) | r \in extensional(P) \cap intensional(P) \rbrace \rbrace$$</li>
<li>$\mathcal{P}$ is comprised the set of labels for all EDB and IDB relations.
$$\small \lbrace label(r) | r \in extensional(P) \cap intensional(P) \rbrace$$</li>
<li>In $\small\text{Datalog}$, which does not allow functions, $\mathcal{F}=\empty$. However, in $\small\text{Datalog}^{\theta}$ which allows certain operators in arithmetic literals $\mathcal{F}=\theta$.</li>
<li>For each rule $\small r \in rules(P)$:</li>
</ol>
<p><strong>TBD</strong></p>
<hr />
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p>In Datalog a pure rule must also follow the safety constraint that all variables that appear in the head <strong>must also</strong> appear in the body.</p>
</div>
<div class="footnote-definition" id="2"><sup class="footnote-definition-label">2</sup>
<p>In Datalog a fact <strong>must also</strong> be ground.</p>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../reference/relational_ebnf.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../reference/references.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../reference/relational_ebnf.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../reference/references.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../datalog.js"></script>
        <script src="../dot.js"></script>
        <script src="../asdi.js"></script>


    </div>
    </body>
</html>
